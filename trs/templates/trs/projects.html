{% extends "trs/base.html" %}
{% load trs_formatting %}

{% block main-column %}
  <h1>Projecten</h1>
  <table class="table table-hover table-condensed">
    <thead>
      <tr>
        <th>Project</th>
        <th>Omschrijving</th>
        <th class="text-right">Verliesuren</th>
        <th class="text-right">Opdrachtsom</th>
        <th class="text-right"
            title="Inclusief nog niet betaalde facturen">Gefactureerd</th>
        <th class="text-right">Gefactureerd t.o.v. opdrachtsom</th>
      </tr>
    </thead>
    <tbody>
      {% for line in view.lines %}
        <tr>
          <td>
            {{ line.project.as_widget }}
          </td>
          <td>
            <span class="text-muted">{{ line.project.description }}</span>
          </td>
          <td class="text-right {{ line.klass }}">
            {{ line.project.overbooked|hours }}
          </td>
          <td class="text-right">
            {{ line.project.contract_amount|money }}
          </td>
          <td class="text-right">
            {{ line.invoice_amount|money }}
          </td>
          <td class="text-right">
            {% if line.invoice_amount_percentage != None %}
              {{ line.invoice_amount_percentage }}%
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  {% if view.can_add_project %}
    <hr>
    <p>
      <a href="{% url 'trs.project.new' %}" class="btn btn-default">
        <span class="glyphicon glyphicon-plus"></span>
        Voeg nieuw project toe
      </a>
    </p>
  {% endif %}
{% endblock %}

{% block overview-column %}
  {% if view.can_see_everything %}
    <h1>Totaal</h1>
    <div>Verhouding gefactureerd t.o.v. opdrachtsom:</div>
    <div style="font-size: 500%">
      {{ view.total_invoice_amount_percentage.percentage }}%
    </div>
    <div>
      Totaal gefactureerd:
      {{ view.total_invoice_amount_percentage.invoice_amount|money }}
    </div>
    <div>
      Totaal opdrachtsommen:
      {{ view.total_invoice_amount_percentage.contract_amount|money }}
    </div>

  {% endif %}
{% endblock %}
