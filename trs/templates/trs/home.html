{% extends "trs/base.html" %}
{% load trs_formatting %}

{% block main-column %}
  <h1>Tijdregistratiesysteem & projectoverzicht</h1>

  {% if view.are_there_changes %}
    <p>
      Bij deze de relevante veranderingen vanaf
      {{ view.start_week.first_day }}
    </p>

    {% if view.person_changes %}
      <div class="panel panel-default">
        <div class="panel-heading">
          Verandering aan jouw instellingen
        </div>
        <div class="panel-body">
          {% if view.person_changes.hours_per_week__sum %}
            <div>
              <b>Werkweek:</b>
              {{ view.person_changes.hours_per_week__sum|hoursdiff }}
            </div>
          {% endif %}
          {% if view.person_changes.target__sum %}
            <div>
              <b>Target:</b>
              {{ view.person_changes.target__sum|moneydiff }}
            </div>
          {% endif %}
          {% if view.person_changes.standard_hourly_tariff__sum %}
            <div>
              <b>Standaard uurtarief:</b>
              {{ view.person_changes.standard_hourly_tariff__sum|moneydiff }}
            </div>
          {% endif %}
          {% if view.person_changes.minimum_hourly_tariff__sum %}
            <div>
              <b>Minimum uurtarief:</b>
              {{ view.person_changes.minimum_hourly_tariff__sum|moneydiff }}
            </div>
          {% endif %}
          {% if view.person_changes.external_percentage__sum %}
            <div>
              <b>Percentage extern:</b>
              {{ view.person_changes.external_percentage__sum|hoursdiff }}
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}

    {% for change in view.work_changes %}
      <div class="panel panel-default">
        <div class="panel-heading">
          Verandering aan je werk op
          {{ change.project.as_widget }}
        </div>
        <div class="panel-body">
          {% if change.hours__sum %}
            <div>
              <b>Toegekende uren:</b>
              {{ change.hours__sum|hoursdiff }}
            </div>
          {% endif %}
          {% if change.hourly_tariff__sum %}
            <div>
              <b>Uurtarief:</b>
              {{ change.hourly_tariff__sum|hoursdiff }}
            </div>
          {% endif %}
        </div>
      </div>
    {% endfor %}


    <h2>Veranderingen aan je projecten</h2>
    <p>
      TODO: BudgetAssignments en facturen ingevoerd danwel betaald.
    </p>

  {% else %}
    <p>Er zijn de laatste tijd geen wijzigingen.</p>
  {% endif %}

{% endblock %}
