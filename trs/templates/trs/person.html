{% extends "trs/base.html" %}
{% load trs_formatting %}

{% block main-column %}
  <h1>{{ view.person.name }}</h1>
  <dl>
    <dt>Werkweek</dt>
    <dd>{{ view.person.hours_per_week|hours }}</dd>
    <dt>Werkvoorraad</dt>
    <dd>{{ view.total_left_to_book|hours }}</dd>
    {% if view.can_see_financials %}
      <dt>Target</dt>
      <dd>{{ view.person.target|money }}</dd>
      <dt>Standaard uurtarief</dt>
      <dd>{{ view.person.standard_hourly_tariff|money }}</dd>
      <dt>Minimum uurtarief</dt>
      <dd>{{ view.person.minimum_hourly_tariff|money }}</dd>
      <dt>Verhouding extern/intern</dt>
      <dd>{{ view.person.external_internal_ratio }}</dd>
    {% endif %}
    <dt>Bij qua boeken</dt>
    <dd>{{ view.person.booking_percentage }}%</dd>
    <dt>Extra rollen</dt>
    <dd>{{ view.extra_roles }}</dd>
  </dl>
  {% if view.can_edit_person %}
    <div>
      <a href="{% url 'trs.person.edit' pk=view.person.pk %}"
         class="btn btn-default">
        <span class="glyphicon glyphicon-pencil"></span>
        Wijzig
      </a>
      &nbsp;
      <a href="{% url 'trs.person.target' pk=view.person.pk %}"
         class="btn btn-default">
        <span class="glyphicon glyphicon-pencil"></span>
        Wijzig target/werkweek/uurtarief/ratio
      </a>
    </div>
  {% endif %}

  <h2>Projecten</h2>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>Project</th>
        <th class="text-right">Toegekend</th>
        <th class="text-right">Geboekt</th>
        {% if view.can_see_financials %}
          <th class="text-right">Tarief</th>
          <th class="text-right">Omgezet</th>
        {% endif %}
      </tr>
    </thead>
    <tbody>
      {% for ppc in view.ppcs %}
        <tr>
          <td>
            {{ ppc.project.as_widget }}
            {% if ppc.is_project_leader %}
              &nbsp;<span class="label label-default">PL</span>
            {% endif %}
            {% if ppc.is_project_manager %}
              &nbsp;<span class="label label-default">PM</span>
            {% endif %}
            <br>
            <span class="text-muted">{{ ppc.project.description }}</span>
          </td>
          <td class="text-right">{{ ppc.budget|hours }}</td>
          <td class="text-right
                     {% if ppc.is_overbooked %}text-danger{% endif %}">
            {{ ppc.booked|hours }}
          </td>
          {% if view.can_see_financials %}
            <td class="text-right">{{ ppc.hourly_tariff|money }}</td>
            <td class="text-right">{{ ppc.turnover|money }}</td>
          {% endif %}
        </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <th>Totaal</th>
        <td class="text-right"></td>
        <th class="text-right">{{ view.total_booked|hours }}</th>
        {% if view.can_see_financials %}
          <td class="text-right"></td>
          <th class="text-right">
            {{ view.total_external_turnover|money }}<br>
            <small>(extern)</small>
          </th>
        {% endif %}
      </tr>
    </tfoot>
  </table>
{% endblock %}

{% block overview-column %}
  {# No personal sidebar here, it would be too confusing next #}
  {# to someone else's data. #}
{% endblock %}
